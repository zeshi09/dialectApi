# –•—Ä–æ–Ω–æ–Ω–∏–º—ã –ö–æ—Å—Ç—Ä–æ–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ö—Ä–æ–Ω–æ–Ω–∏–º–æ–≤ (–Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤, –¥–Ω–µ–π) –ö–æ—Å—Ç—Ä–æ–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ 5000+ —Ö—Ä–æ–Ω–æ–Ω–∏–º–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å –º–∞—Ä–∫–µ—Ä–∞–º–∏ –ª–æ–∫–∞—Ü–∏–π
- üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, —Ä–∞–π–æ–Ω—É –∏ —Å–µ–ª—å—Å–æ–≤–µ—Ç—É
- üîÑ –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
- üìã –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
- üé® –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å—Ç–∏–ª–µ –∫–æ—Å—Ç—Ä–æ–º—Å–∫–æ–π —Ä–æ—Å–ø–∏—Å–∏
- ‚ôæÔ∏è –ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ (–ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend**: Go 1.21 —Å Ent ORM
- **Frontend**: HTMX, Vanilla JavaScript
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 16
- **–ö–∞—Ä—Ç—ã**: –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã API
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Docker Compose

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
dialectApi/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/          # Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ main.go
‚îÇ       ‚îî‚îÄ‚îÄ dbConnect.go
‚îú‚îÄ‚îÄ ent/                 # Ent ORM —Å—Ö–µ–º—ã –∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ templates/           # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ static/              # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ path1.png
‚îÇ   ‚îú‚îÄ‚îÄ LondonRus52-Condensed.otf
‚îÇ   ‚îú‚îÄ‚îÄ Kostromskaya.geojson
‚îÇ   ‚îî‚îÄ‚îÄ clipboard-svgrepo-com.svg
‚îú‚îÄ‚îÄ data/                # CSV –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ chrononyms_fin.csv
‚îÇ   ‚îî‚îÄ‚îÄ districts_coords.csv
‚îú‚îÄ‚îÄ scripts/             # Python —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ file.py
‚îÇ   ‚îú‚îÄ‚îÄ migrate.py
‚îÇ   ‚îú‚îÄ‚îÄ update_db.py
‚îÇ   ‚îî‚îÄ‚îÄ init_db_docker.py
‚îú‚îÄ‚îÄ Dockerfile           # Dockerfile –¥–ª—è Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Dockerfile.init      # Dockerfile –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ docker-compose.yml   # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ init.sql             # SQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
‚îî‚îÄ‚îÄ README.md
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker & Docker Compose
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Go 1.21+ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Python 3.11+ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–∫—Ä–∏–ø—Ç–∞–º–∏

### –ó–∞–ø—É—Å–∫ —Å Docker

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd dialectApi

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose up -d

# 3. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
open http://localhost:9090
```

Docker Compose –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ó–∞–ø—É—Å—Ç–∏—Ç PostgreSQL 16
- –°–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã
- –ó–∞–≥—Ä—É–∑–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV
- –°–æ–±–µ—Ä–µ—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
docker compose down

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
docker compose down -v
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ Docker

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
docker compose up postgres -d

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ë–î (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
docker compose up db-init

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
go run ./cmd/server
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π

#### –°–ø–æ—Å–æ–± 1: –ü–æ–ª–Ω–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ `data/chrononyms_fin.csv`
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç–µ `data/districts_coords.csv`
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É:

```bash
docker compose down -v
docker compose up -d
```

#### –°–ø–æ—Å–æ–± 2: –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install psycopg2-binary

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
python3 scripts/update_db.py
```

–°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏, –∏–∑–±–µ–≥–∞—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤

```bash
# –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –æ–±—Ä–∞–∑—ã
docker compose build

# –°–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
docker compose build app

# –°–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –ë–î
docker compose build db-init
```

## API Endpoints

- `GET /` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `GET /api/locations` - –°–ø–∏—Å–æ–∫ –ª–æ–∫–∞—Ü–∏–π (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
- `GET /api/markers` - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–∞—Ä–∫–µ—Ä–æ–≤ –¥–ª—è –∫–∞—Ä—Ç—ã
- `GET /api/filters` - –°–ø–∏—Å–∫–∏ —Ä–∞–π–æ–Ω–æ–≤ –∏ —Å–µ–ª—å—Å–æ–≤–µ—Ç–æ–≤
- `GET /detail?id=<id>` - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–æ–∫–∞—Ü–∏–∏
- `GET /static/*` - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

- `search` - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ö—Ä–æ–Ω–æ–Ω–∏–º–∞
- `district` - –§–∏–ª—å—Ç—Ä –ø–æ —Ä–∞–π–æ–Ω—É
- `selsovet` - –§–∏–ª—å—Ç—Ä –ø–æ —Å–µ–ª—å—Å–æ–≤–µ—Ç—É
- `offset` - –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `limit` - –õ–∏–º–∏—Ç –∑–∞–ø–∏—Å–µ–π

–ü—Ä–∏–º–µ—Ä:
```
/api/locations?search=–∞–≤–¥–æ–∫–µ—è&district=–ü–∞–≤–∏–Ω—Å–∫–∏–π&offset=0&limit=100
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã `locations`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| id | INTEGER | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| chrononym | TEXT | –ù–∞–∑–≤–∞–Ω–∏–µ —Ö—Ä–æ–Ω–æ–Ω–∏–º–∞ |
| definition | TEXT | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |
| context | TEXT | –ö–æ–Ω—Ç–µ–∫—Å—Ç —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è |
| district | TEXT | –†–∞–π–æ–Ω |
| selsovet | TEXT | –°–µ–ª—å—Å–æ–≤–µ—Ç |
| latitude | REAL | –®–∏—Ä–æ—Ç–∞ |
| longitude | REAL | Longitude |
| comment | TEXT | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
| year | TEXT | –ì–æ–¥ –∑–∞–ø–∏—Å–∏ |
| district_ss | TEXT | –†–∞–π–æ–Ω + —Å–µ–ª—å—Å–æ–≤–µ—Ç |

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

```bash
# –ß–µ—Ä–µ–∑ Docker
docker exec -it dialect_postgres psql -U postgres -d location

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
SELECT COUNT(*) FROM locations;

# –í—ã–π—Ç–∏
\q
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- `DB_HOST` - —Ö–æ—Å—Ç PostgreSQL (default: localhost)
- `DB_PORT` - –ø–æ—Ä—Ç PostgreSQL (default: 5432)
- `DB_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (default: postgres)
- `DB_PASSWORD` - –ø–∞—Ä–æ–ª—å (default: postgres)
- `DB_NAME` - –∏–º—è –ë–î (default: location)

## Troubleshooting

### –ü–æ—Ä—Ç 9090 —É–∂–µ –∑–∞–Ω—è—Ç

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
lsof -ti:9090

# –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill -9 $(lsof -ti:9090)

# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ docker-compose.yml
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
docker compose logs db-init

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –ë–î
docker compose down -v
docker compose up -d
```

### –ö–∞—Ä—Ç–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç –≤ `templates/index.html`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–∞ `static/Kostromskaya.geojson`

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

[–í–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã]
